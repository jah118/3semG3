@model IList<DataTransferObjects.FoodDTO>

@{
    <h2> Bestilling af mad</h2>

}
@using (Html.BeginForm()) {
<table style="width: 100% !important; height: 100% !important">
    <tr style="width:100%; height:16%">
        <td rowspan="3">
            <table style="width: 100% !important; height: 100% !important;">
                <tr>
                    <td align="center" style="width:50%">
                        <div class="form-group">
                            <div class="col-md-5">
                         
                            </div>
                        </div>
                        <div>
                            <label>Retter</label>
                        </div>
                        <div id="foodListDiv" style=" overflow: scroll; min-height: 100px; max-height: 300px; width: 90%">
                            <select name="Tables" id="Tables2" class="form-control" multiple>
                                @if (Model != null)
                                {
                                    foreach (var x in Model)
                                    {
                                        <option value="@x.Id">  @x.Name </option>
                                    }
                                }
                            </select>
                            <table id="foodTable" style="width:100%; height:100%">
                            </table>
                        </div>
                    </td>
                    <td align="center">
                        <div>
                            <label>Drikkevare</label>
                        </div>
                        <div style="overflow: scroll; min-height:100px; max-height: 300px; width:90%">
                            <table id="drinkTable" style="width:100%; height:100%"></table>
                        </div>
                        <div>
                        </div>
                    </td>
                </tr>
            </table>
        </td>
        <td>
            <div><button disabled="disabled">Se menu</button></div>
        </td>
    </tr>
    <tr></tr>
    <tr></tr>
    <tr></tr>
    <tr></tr>
    <tr style="width:100%; height:100%">
        <td rowspan="2">
            <div style="        overflow: scroll;
        max-height: 100px;
        margin-top: 20px;
        border:medium
">
                <div>
                    <label>Ordre:</label>
                </div>
                <table id="summaryTable" border="1" style="width:100%">
                </table>
            </div>
        </td>
    </tr>
    <tr></tr>
    <tr></tr>
    <tr id="FooterCol" style="width:100%; height:16%">
        <td align="right" colspan="2">
            <div><a href="/Booking/Create" onclick="btnBackClick()" class="btn btn-info" role="button"> Back..</a></div>
        </td>
    </tr>
</table>
                             }

<script>
    var summary = [];
    

    function btnBackClick() {

    }

    function updateFoodViewTable() {
        var table = document.getElementById("foodTable");
        table.innerHTML = "";
        dataFood.forEach(
            x => {
                (x)
                var row = table.insertRow(0);
                var c1 = row.insertCell(0);
                c1.innerHTML = x;
            });
    }

    function updateDrinkViewTable() {
        var table = document.getElementById("drinkTable");
        table.innerHTML = "";
        dataDrink.forEach(
            x => {
                (x)
                var row = table.insertRow(0);
                var c1 = row.insertCell(0);
                c1.innerHTML = x + "";
            });
    }

    function addFoodToSummaryList() {


        summary.push(row.value);
        updateSummaryTable();

    }
    function removeDrinkFromSummaryList() {
        var food = "Some drink";
        for (i = 0; i < summary.length; i++) {
            x = summary[i];
            if (x == food) {
                delete summary[i];
                break;
            }
        }
        updateSummaryTable();
    }
    function addDrinkToSummaryList() {
        summary.push("Some drink")
        updateSummaryTable();
    }
    function removeFoodFromSummaryList() {
        var food = "Some food";
        for (i = 0; i < summary.length; i++) {
            x = summary[i];
            if (x == food) {
                delete summary[i];
                break;
            }
        }
        updateSummaryTable();
    }

    function countItems(v) {
        var count = 0;
        summary.forEach((x) => {
            if (x == v) {
                count++;
            }
        });
        return count;
    }
    function updateSummaryTable() {
        var table = document.getElementById("summaryTable");
        var temp = [];
        table.innerHTML = "";
        summary.forEach(
            x => {
                (x)
                if (temp.find(y => y == x) == null) {
                    temp.push(x);
                    var row = table.insertRow(0);
                    var c1 = row.insertCell(0);
                    var c2 = row.insertCell(1);
                    c1.innerHTML = x + "";
                    c2.innerHTML = countItems(x) + " stk.";

                    row.onclick = function () {
                        var item = this.cells[0].innerHTML;
                        for (i = 0; i < summary.length; i++) {
                            x = summary[i];
                            if (x == item) {
                                delete summary[i];
                                break;
                            }
                        }
                        updateSummaryTable();
                    }
                }

            });
    }

    updateFoodViewTable();
    updateDrinkViewTable();

    var table = document.getElementById('drinkTable');

    for (var i = 0; i < table.rows.length; i++) {
        table.rows[i].onclick = function () {
            summary.push(this.cells[0].innerHTML)
            updateSummaryTable();
        };
    }

    var table = document.getElementById('foodTable');

    for (var i = 0; i < table.rows.length; i++) {
        table.rows[i].onclick = function () {
            summary.push(this.cells[0].innerHTML)
            updateSummaryTable();
        };
    }
</script>

@* used for clientside validation through jquery validation and jquery validation unobtrusive libs  *@
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
